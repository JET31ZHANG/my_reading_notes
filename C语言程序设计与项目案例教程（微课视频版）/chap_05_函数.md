## 概述

- 函数引入
  - 从函数定义角度
    - 库函数
    - 用户定义函数

  - 从对函数返回值的需求状况
    - 有返回值
    - 无返回值

  - 从主调函数和被调函数之间数据传送的角度
    - 无参函数
    - 有参函数

  - 从功能角度

- 函数的定义
- 函数的调用
- 函数的声明
- 函数的参数传递
- 返回语句和函数返回值
- 函数的嵌套调用
- 函数的递归调用

## 变量作用域&生命期

- 变量的作用域
- 变量的生命期
- 变量的存储类型
  - auto类型
  - register类型
  - static类型
  - extern类型
- 内部函数
- 外部函数

## 预处理程序

- 宏定义

  - 不带参数的宏定义（字符串的宏定义）：用来指定一个标识符代表一个字符串常量。

    ```C
    // #define 标识符 字符串
    // 标识符是宏的名字，字符串是宏的替换正文，使得标识符等同于字符串
    ```

    - 宏定义在源程序中要单独占一行，通常 "#" 出现在一行的第一个字符的位置，允许 # 号前有若干空格或制表符，但不允许有其他字符。

    - 每个宏定义以换行符作为结束的标志

    - 宏的名字用大小写均可，习惯用大写字母作为宏名。宏名是一个常量的标识符，不能对它赋值。

    - 一个宏的作用域：从定义的地方开始到本文件结束。也可以用 “#undef” 命令终止宏定义的作用域

    - 宏定义可以嵌套

      ```c
      #define PI 3.14
      #define TWOPI (2.0 * PI)
      // 若有语句 s = TWOPI * r * r , 则在编译时被替换为 s = (2.0 * PI) * r * r
      ```

  - 带参数的宏定义：进行参数替换

    ```c
    // #define 标识符(参数表) 字符串
    # define SUM(a, b)(a + b)
    ```

    - 在宏定义中，宏名和左括号之间没有空格
    - 带参数的宏展开时，用实参字符串替换形参字符串，可能会发生错误。建议：***将宏的各个参数用小括号括起来。***
    - 带参数的宏调用和函数调用的区别：
      - 函数调用：先计算实参表达式的值，再将它的值传递给形参，在传递过程中，要检查实参和形参的数据类型是否一致。
      - 带参数的宏替换：只是简单的字符串替换，不存在函数类型、返回值及参数类型的问题。它是用实参表达式原封不动地替换形参，并不进行计算，也不检查参数类型的一致性。

- 文件包含：把指定文件的全部内容包含到本文件中。

  - 一个 include 命令只能指定一个被包含文件
  - 文件包含控制行可出现在源文件的任何地方，但大多放在文件的开头部分
  - "#include" 命令的文件名使用双引号和尖括号的区别：
    - 使用尖括号：仅在系统指定的"标准"目录中查找文件，不在源文件的目录中查找
    - 使用双引号：表明先在正在处理的源文件目录中搜索指定的文件，若没有，再到系统指定的"标准"目录中查找。

  - 文件包含命令可以是嵌套的，在一个被包含的文件中还可以包含其他的文件。

- 条件编译：***用于程序调试***

  - 使用 #ifdef 的形式

    ```c
    /*
    *	当标识符已经被 #define 命令所定义时，
    *	条件为真，编译程序段1；
    *	否则条件为假，编译程序段2。
    *	else 语句可以没有。
    */
    #ifdef 标识符
    	程序段 1
    #else
        程序段 2
    #endif
    ```

  - 使用 #ifndef 的形式

    ```C
    /* 
    *	当标识符未被 #define 命令所定义时，
    *	条件为真，编译程序段1；
    *	否则条件为假，编译程序段2。
    *	else 语句可以没有。
    */
    #ifndef 标识符
    	程序段 1
    #else
        程序段 2
    #endif
    ```

  - 使用 #if 的形式

    ```c
    /*
    *	当表达式的值为非0时，条件为真，编译表达式后的程序段1；
    *	否则条件为假，编译程序段2。
    */
    #if 表达式
    	程序段 1
    #else
        程序段 2
    #endif
    ```

- 特殊符号处理

  - `_FILE_`:  包含当前程序文件名的字符串
  - `_LINE_`: 表示当前行号的整数
  - `_DATE_`: 包含当前日期的字符串
  - `_STDC_`: 若编译器遵循 ANSI C 标准，则它是个非 0 值
  - `_TIME_`: 包含当前时间的字符串


## 常见错误

- 使用库函数时忘记包含头文件

  ```c
  #include <stdio.h>
  
  int main(void)
  {
      int a = 4;
      printf("%f", sqrt(a));	// 使用 sqrt() 需要包含 math.h
      
      return 0;
  }
  ```

- 忘记对所调用的函数进行函数原型声明

  ```c
  #include <stdio.h>
  // 要调用 add() 函数，需在 main() 前声明 add()
  int main(void)
  {
      float a, b;
      
      printf("Please enter a and b: ");
      scanf("%f %f", &a, &b);
      printf("the sum is: %.2f\n", add(a, b));
      
      return 0;
  }
  
  float add(float x, float y)
  {
      float z = 0;
      z = x + y;
      return (z);
  }
  ```

- 函数的实参和形参类型不一致

  ```c
  #include <stdio.h>
  
  int sum(int i, int j)
  {
      int k;
      k = i + j;
      return k;
  }
  
  int main(void)
  {
      float a, b, c = 0;      // 函数实参和形参不一致
      printf("请输入两个实数: ");
      scanf("%d %d", &a, &b);
      c = sum(a, b);
      printf("a + b = %f\n", c);
  
      return 0;
  }
  ```

- 使用未赋值的自动变量

  ```c
  #include <stdio.h>
  
  int main(void)
  {
      int i;
      printf("%d\n", i);	// i 未赋值
  }
  ```
