## 文件的概述和基本操作

- 文件概述
  - 文件分类
  
    - 用户角度
      - 普通文件：驻留在磁盘或其他外部介质上的一个有序数据集。
      - 设备文件：与主机相连的各种外部设备。在操作系统中，把外部设备也看做一个文件来进行管理，把它们的输入、输出等同于对磁盘文件的读和写。
    - 文件编码方式
      - ASCII 文件（文本文件）：在磁盘中存放时，每个字符对应 1 字节，用于存放对应的 ASCII 码。
      - 二进制文件：按二进制的编码方式来存放文件。
    - 文件处理方式
      - 缓冲文件系统（标准文件系统、高层文件系统）：常用的文件系统，也是 ANSI C 建议使用的文件系统。通用性好、功能强、使用方便。
      - 非缓冲文件系统（底层文件系统）：与机器有关，有用较为困难，节省内存，执行效率较高。
  
  - 文件指针：用一个指针变量指向文件。对所指的文件进行各种操作
  
    ```c
    FILE * fp;		// fp 为指向一个文件的指针
    ```
  
- 文件的打开、关闭
  - 文件打开函数 fopen()
  
    | 文件使用方式    | 含义                     | 说明                                               |
    | --------------- | ------------------------ | -------------------------------------------------- |
    | "rt"（只读）    | 打开文本文件，只读       | 如果指定文件不存在，则出错                         |
    | "wt"（只写）    | 打开文本文件，只写       | 新建一个文件，如果指定文件已存在，则删除它，再新建 |
    | "at"（追加）    | 打开文本文件，追加       | 如果指定文件不存在，则创建该文件                   |
    | "rb"（只读）    | 打开二进制文件，只读     | 如果指定文件不存在，则出错                         |
    | "wb"（只写）    | 打开二进制文件，只写     | 新建一个文件，如果指定文件已存在，则删除它，再新建 |
    | "ab"（追加）    | 打开二进制文件，追加     | 如果指定文件不存在，则创建该文件                   |
    | "rt+"（读写）   | 打开文本文件，读、写     | 如果指定文件不存在，则出错                         |
    | "wt+"（读写）   | 打开文本文件，读、写     | 新建一个文件，如果指定文件已存在，则删除它，再新建 |
    | "at+"（读追加） | 打开文本文件，读、追加   | 如果指定文件不存在，则创建该文件                   |
    | "rb+"（读写）   | 打开二进制文件，读、写   | 如果指定文件不存在，则出错                         |
    | "wb+"（读写）   | 打开二进制文件，读、写   | 新建一个文件，如果指定文件已存在，则删除它，再新建 |
    | "ab+"（都追加） | 打开二进制文件，读、追加 | 如果指定文件不存在，则创建该文件                   |
  
    
  
    - 文件使用方式由r(read)为读、w(write)为写、a(append)为追加、t(text)为文本文件可省略不写、b(二进制文件) 和 +(读和写) 这6个字符组成。
    - 用以上方式可打开文本文件或二进制文件，这是 ANSI C 的规定，即用同一种文件缓冲系统来处理文本文件和二进制文件。
    - 在读取文本文件时，会自动将回车、换行两个字符转换为一个换行符。写入时，会自动将一个换行符转换为回车和换行两个字符。在用二进制文件时，不会进行这种转换。
    - 打开一个文件时，若出错，fopen() 函数将返回一个空指针值 NULL。
  
  - 文件关闭函数 fclose()
  
- 文件的读写
  - 写字符函数 fputc()
  - 读字符函数 fgetc()
  - 写字符串函数 fputs()
  - 读字符串函数 fgets()
  - 数据块读写函数 fread() fwrite()
  - 格式化读写函数 fscanf() fprintf()
  
- 文件定位
  - rewind()
  - fseek()
  - ftell()
  - feof()
  - ferror()
  - clearerr()

## 常见错误

- 文件操作要素不全

- 打开方式有误

  ```c
  // 用只读方式打开文件，却试图向该文件写入数据，显然是不行的
  if((fp = fopen("test", "r")) == NULL)
  {
  	printf("Cannot open file!");
      exit(0);
  }
  fputs(str, fp);
  ```

- 文件位置指针混乱
